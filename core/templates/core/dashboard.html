<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Loan Tracer Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 250px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .card h2 {
      font-size: 36px;
      margin: 10px 0;
    }
    .card span {
      font-weight: bold;
      font-size: 18px;
      color: #555;
    }
    .green {
      color: green;
    }
    .red {
      color: red;
    }

    .links {
      text-align: center;
      margin-top: 40px;
    }

    .links a {
      text-decoration: none;
      margin: 0 15px;
      font-weight: bold;
      color: #007bff;
    }
    .recent-grid ul li {
  background: #f7f7f7;
  margin-bottom: 8px;
  padding: 8px 10px;
  border-radius: 6px;
  font-size: 0.95em;
}

  </style>
</head>
<body>
  <h1>Loan Tracer Dashboard</h1>
<form method="get" style="text-align:center; margin-bottom: 30px;">
  <input type="text" name="name" placeholder="Search by name" value="{{ name_query }}" />
  <input type="date" name="date" value="{{ date_query }}" />
  <button type="submit">🔍 Filter</button>
  <a href="/" style="margin-left: 10px;">Clear</a>
</form>
<div style="text-align: right; margin-bottom: 15px;">
  <a href="{% url 'data_entry' %}" class="btn btn-primary" style="padding: 10px 16px; background-color: #4f46e5; color: white; border-radius: 6px; text-decoration: none;">
    ➕ Add New Record
  </a>
</div>

  <div class="cards">
    <div class="card">
      <span>Total Clients</span>
      <h2>{{ total_clients }}</h2>
    </div>

    <div class="card">
      <span>Total Loaned</span>
      <h2>KES {{ total_loaned }}</h2>
    </div>

    <div class="card">
      <span>Total Collected</span>
      <h2>KES {{ total_collected }}</h2>
    </div>

    <div class="card">
      <span>Total Remaining</span>
      <h2 class="{% if total_remaining <= 0 %}green{% else %}red{% endif %}">
        KES {{ total_remaining }}
      </h2>
    </div>
  </div>

  <hr>
<h2 style="margin-top: 40px;">📌 Recent Activity</h2>
<div class="recent-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 20px;">

  <!-- Recent Loans -->
  <div>
    <h4>🧾 Recent Loans</h4>
    <ul style="list-style: none; padding-left: 0;">
      {% for loan in recent_loans %}
        <li>{{ loan.date }} — <strong>{{ loan.client.name }}</strong>: KES {{ loan.amount }}</li>
      {% empty %}
        <li>No loans yet.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Recent Payments -->
  <div>
    <h4>💰 Recent Payments</h4>
    <ul style="list-style: none; padding-left: 0;">
      {% for p in recent_payments %}
        <li>{{ p.date }} — <strong>{{ p.client.name }}</strong>: KES {{ p.amount }}</li>
      {% empty %}
        <li>No payments yet.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Recent Money Out -->
  <div>
    <h4>📤 Money Out</h4>
    <ul style="list-style: none; padding-left: 0;">
      {% for m in recent_moneyouts %}
        <li>{{ m.date }} — {{ m.description }}: KES {{ m.amount }}</li>
      {% empty %}
        <li>No expenses yet.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Opening Balances -->
  <div>
    <h4>📈 Opening Balances</h4>
    <ul style="list-style: none; padding-left: 0;">
      {% for o in recent_openings %}
        <li>{{ o.date }}: KES {{ o.amount }}</li>
      {% empty %}
        <li>No opening balances yet.</li>
      {% endfor %}
    </ul>
  </div>
</div>

  <div class="links">
  <a href="{% url 'daily-summary' %}">📅 Daily Summary</a>
  <a href="{% url 'client-summary' %}">👥 Client Summary</a>
  <a href="{% url 'daily-summary-pdf' %}?date={{ date_query|default:today|date:'Y-m-d' }}" target="_blank">
    📁 Daily PDF
  </a>
  <a href="{% url 'client-summary-pdf' %}?name={{ name_query }}" target="_blank">
    📁 Client PDF
  </a>

  </div>
  <a href="{% url 'data_entry' %}" title="Add New Entry" style="
  position: fixed;
  bottom: 30px;
  right: 30px;
  background-color: #4CAF50;
  color: white;
  padding: 12px 20px;
  border-radius: 50px;
  font-size: 18px;
  text-decoration: none;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  z-index: 1000;
">＋</a>

</body>
</html>
